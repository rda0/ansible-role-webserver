include_webserver_apache2: True
include_webserver_letsencrypt: True
include_webserver_phpfpm: False
include_webserver_sites_include: False
include_webserver_vhosts: False
include_webserver_website_statistics: True
import_webserver_letsencrypt_cronjob: True

websserver_log_level: warn

webserver_net4_adm: '{{ ((iptables_net4_adm|default({})).values()|list + (iptables_net4_adm_custom|default({})).values()|list)|sort }}'
webserver_net6_adm: '{{ ((iptables_net6_adm|default({})).values()|list + (iptables_net6_adm_custom|default({})).values()|list)|sort }}'
webserver_net4_san: '{{ ((iptables_net4_san|default({})).values()|list + (iptables_net4_san_custom|default({})).values()|list)|sort }}'
webserver_net6_san: '{{ ((iptables_net6_san|default({})).values()|list + (iptables_net6_san_custom|default({})).values()|list)|sort }}'
webserver_net4_srv: '{{ ((iptables_net4_srv|default({})).values()|list + (iptables_net4_srv_custom|default({})).values()|list)|sort }}'
webserver_net6_srv: '{{ ((iptables_net6_srv|default({})).values()|list + (iptables_net6_srv_custom|default({})).values()|list)|sort }}'
webserver_net4_lan: '{{ ((iptables_net4_lan|default({})).values()|list + (iptables_net4_lan_custom|default({})).values()|list)|sort }}'
webserver_net6_lan: '{{ ((iptables_net6_lan|default({})).values()|list + (iptables_net6_lan_custom|default({})).values()|list)|sort }}'
webserver_net4_can: '{{ ((iptables_net4_can|default({})).values()|list + (iptables_net4_can_custom|default({})).values()|list)|sort }}'
webserver_net6_can: '{{ ((iptables_net6_can|default({})).values()|list + (iptables_net6_can_custom|default({})).values()|list)|sort }}'
webserver_net4_prvcan: '{{ ((iptables_net4_prvcan|default({})).values()|list + (iptables_net4_prvcan_custom|default({})).values()|list)|sort }}'
webserver_net6_prvcan: '{{ ((iptables_net6_prvcan|default({})).values()|list + (iptables_net6_prvcan_custom|default({})).values()|list)|sort }}'
webserver_net4_cun: '{{ (iptables_net4_cun_custom|default({})).values()|list|sort }}'
webserver_net6_cun: '{{ (iptables_net6_cun_custom|default({})).values()|list|sort }}'

webserver_tls_enable_insecure_compatibility: False
webserver_tls_v1_2_cipher_spec: "{{ 'non_aead' if webserver_tls_enable_insecure_compatibility else 'aead' }}"
webserver_tls_cipher_order:
  tlsv1_3: chacha20_aes128_aes256
  tlsv1_2: chacha20_aes128_aes256
webserver_tls_cipher_specs:
  tlsv1_3:
    openssl_default: TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256
    aes256_aes128_chacha20: TLS_AES_256_GCM_SHA384:TLS_AES_128_GCM_SHA256:TLS_CHACHA20_POLY1305_SHA256
    aes128_aes256_chacha20: TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256
    chacha20_aes128_aes256: TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384
  tlsv1_2:
    aead:
      aes256_aes128_chacha20: kECDHE+aECDSA+AESGCM:kECDHE+aECDSA+CHACHA20:kECDHE+aRSA+AESGCM:kECDHE+aRSA+CHACHA20:kDHE+aRSA+AESGCM:kDHE+aRSA+CHACHA20
      aes128_aes256_chacha20: kECDHE+aECDSA+AESGCM+AES128:kECDHE+aECDSA+AESGCM+AES256:kECDHE+aECDSA+CHACHA20:kECDHE+aRSA+AESGCM+AES128:kECDHE+aRSA+AESGCM+AES256:kECDHE+aRSA+CHACHA20:kDHE+aRSA+AESGCM+AES128:kDHE+aRSA+AESGCM+AES256:kDHE+aRSA+CHACHA20
      chacha20_aes128_aes256: kECDHE+aECDSA+CHACHA20:kECDHE+aECDSA+AESGCM+AES128:kECDHE+aECDSA+AESGCM+AES256:kECDHE+aRSA+CHACHA20:kECDHE+aRSA+AESGCM+AES128:kECDHE+aRSA+AESGCM+AES256:kDHE+aRSA+CHACHA20:kDHE+aRSA+AESGCM+AES128:kDHE+aRSA+AESGCM+AES256
    non_aead:
      aes256_aes128_chacha20: kECDHE+aECDSA+AESGCM:kECDHE+aECDSA+CHACHA20:kECDHE+aECDSA+AES+SHA384:kECDHE+aECDSA+AES+SHA256:kECDHE+aRSA+AESGCM:kECDHE+aRSA+CHACHA20:kECDHE+aRSA+AES+SHA384:kECDHE+aRSA+AES+SHA256:kDHE+aRSA+AESGCM:kDHE+aRSA+CHACHA20:kDHE+aRSA+AES+SHA256
      aes128_aes256_chacha20: kECDHE+aECDSA+AESGCM+AES128:kECDHE+aECDSA+AESGCM+AES256:kECDHE+aECDSA+CHACHA20:kECDHE+aECDSA+AES+SHA256:kECDHE+aECDSA+AES+SHA384:kECDHE+aRSA+AESGCM+AES128:kECDHE+aRSA+AESGCM+AES256:kECDHE+aRSA+CHACHA20:kECDHE+aRSA+AES+SHA256:kECDHE+aRSA+AES+SHA384:kDHE+aRSA+AESGCM+AES128:kDHE+aRSA+AESGCM+AES256:kDHE+aRSA+CHACHA20:kDHE+aRSA+AES128+SHA256:kDHE+aRSA+AES256+SHA256
      chacha20_aes128_aes256: kECDHE+aECDSA+CHACHA20:kECDHE+aECDSA+AESGCM+AES128:kECDHE+aECDSA+AESGCM+AES256:kECDHE+aECDSA+AES+SHA256:kECDHE+aECDSA+AES+SHA384:kECDHE+aRSA+CHACHA20:kECDHE+aRSA+AESGCM+AES128:kECDHE+aRSA+AESGCM+AES256:kECDHE+aRSA+AES+SHA256:kECDHE+aRSA+AES+SHA384:kDHE+aRSA+CHACHA20:kDHE+aRSA+AESGCM+AES128:kDHE+aRSA+AESGCM+AES256:kDHE+aRSA+AES128+SHA256:kDHE+aRSA+AES256+SHA256
webserver_https_ssl_honor_cipher_order: 'on'
webserver_https_ssl_protocol: '-all +TLSv1.3 +TLSv1.2'
webserver_https_ssl_cipher_suite:
  tlsv1_3: "{{ webserver_tls_cipher_specs['tlsv1_3'][webserver_tls_cipher_order['tlsv1_3']] }}"
  tlsv1_2: "{{ webserver_tls_cipher_specs['tlsv1_2'][webserver_tls_v1_2_cipher_spec][webserver_tls_cipher_order['tlsv1_2']] }}"
webserver_https_curves: X25519:secp521r1:secp384r1
webserver_https_dh_params_custom: False
webserver_https_dh_params_size: 4096
webserver_https_dh_params_path: '/etc/ssl/private/dhparam_{{ webserver_https_dh_params_size }}.pem'
webserver_https_certificate_rsa: True
webserver_https_certificate_ecdsa: True
webserver_https_fail_if_certificate_missing: False
webserver_doc_root: /var/www
webserver_empty_doc_root: /var/www/empty
webserver_webshare: False
webserver_webshare_doc_root: /export/data1
webserver_log_lastuse: False
webserver_server_admin: isg@phys.ethz.ch
webserver_ldap: True
webserver_ldap_ethz: False
webserver_ldap_trusted_ca_cert: /etc/ssl/certs/quovadis_global_ica_g2.crt
webserver_modules_default:
  - env
  - headers
  - macro
  - ssl
  - http2
  - status
webserver_modules_custom: []
webserver_packages_custom: []
webserver_config_enable_custom: []
webserver_config_disable_custom: []
webserver_service_start_after_network_online: False
webserver_site_enable_default: True
webserver_site_config_default_vhost_default_https_enablessl: Use EnableSSL
webserver_site_config_common_requires:
  require_all_granted: |
    Require all granted
  require_net_can_and_phys_ldap_group_isg: |
    Use PhysLDAP
    <RequireAll>
      Use RequireNetCan
      Use RequirePhysLDAPGroup isg
    </RequireAll>
  grant_share_all: |
    Require all granted
    AllowOverride AuthConfig Limit Indexes Options=None,Multiviews,Indexes,SymLinksIfOwnerMatch
    AllowOverrideList Redirect RedirectMatch RedirectPermanent RedirectTemp
    Options Multiviews Indexes SymLinksIfOwnerMatch
  grant_share_all_allow_override_none: |
    Require all granted
    AllowOverride None
    AllowOverrideList None
    Options Multiviews SymLinksIfOwnerMatch
  grant_share_all_allow_override_all: |
    Require all granted
    AllowOverride All
    Options All Multiviews SymLinksIfOwnerMatch
  grant_share_phys_ldap: |
    Use PhysLDAP
    Require valid-user
    AllowOverride AuthConfig Limit Indexes Options=None,Multiviews,Indexes,SymLinksIfOwnerMatch
    AllowOverrideList Redirect RedirectMatch RedirectPermanent RedirectTemp
    Options Multiviews Indexes SymLinksIfOwnerMatch
  grant_share_phys_ldap_or_net_can: |
    Use PhysLDAP
    <RequireAny>
      Require valid-user
      Use RequireNetCAN
    </RequireAny>
    AllowOverride AuthConfig Limit Indexes Options=None,Multiviews,Indexes,SymLinksIfOwnerMatch
    AllowOverrideList Redirect RedirectMatch RedirectPermanent RedirectTemp
    Options Multiviews Indexes SymLinksIfOwnerMatch
webserver_site_config_default_vhost_default_require: "{{ webserver_site_config_common_requires.require_net_can_and_phys_ldap_group_isg }}"
webserver_site_deploy_default: True
webserver_site_content_default_title: '{{ ansible_hostname }}'
webserver_site_content_default_description: This server is managed by the <a href="https://www.phys.ethz.ch/services/physics-isg.html">IT Services Group (ISG) in the Physics Department</a>.
webserver_site_content_default_overview: ''

# The certificates can optionally be initialized manually or restored from backup
webserver_letsencrypt_initialize_manually: False
webserver_letsencrypt_restore_from_backup: False

webserver_letsencrypt_restore_from_backup_path: ''
#webserver_letsencrypt_restore_from_backup_path: 'phd-bkp-gw.ethz.ch:/export/backup/system/phd-hostname/current/opt/letsencrypt/'

webserver_letsencrypt_path: /opt/letsencrypt
webserver_letsencrypt_repo: git@gitlab.phys.ethz.ch:Misc/letsencrypt-acmetiny.git
webserver_letsencrypt_branch: "{{ 'master' if webserver_letsencrypt_initialize_manually else 'ansible' }}"
webserver_letsencrypt_aliases:
  - domains:
      - '{{ ansible_fqdn }}'
webserver_letsencrypt_deploy_account_key: True

webserver_phpfpm_pools: []
webserver_sites_include_repo: 'git@gitlab.phys.ethz.ch:webserver/{{ ansible_hostname }}-sites-include.git'
webserver_vhost_data_path:
  server: /var/www
  share: /export/data1
webserver_vhosts: []

# private set_fact variable defaults (do not use in inventory)
_vhosts: []
_vhosts_fcgid: []
